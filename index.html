<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Smart Alarm</title>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    const firebaseConfig = {
      databaseURL: "https://smart-alarm-9c9ee-default-rtdb.asia-southeast1.firebasedatabase.app/"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // ===== Time =====
    onValue(ref(db, "time/current"), (snap) => {
      document.getElementById("time").innerText = snap.val();
    });

    // ===== Sensor =====
    onValue(ref(db, "sensor"), (snap) => {
      const d = snap.val();
      document.getElementById("temp").innerText = d.temperature;
      document.getElementById("hum").innerText = d.humidity;
      document.getElementById("light").innerText = d.light;
    });

    // ===== Alarm Status =====
    onValue(ref(db, "alarm/enable"), (snap) => {
      document.getElementById("status").innerText =
        snap.val() ? "à¹€à¸›à¸´à¸”à¹ƒà¸Šà¹‰à¸‡à¸²à¸™" : "à¸›à¸´à¸”";
    });

    window.setAlarm = () => {
      set(ref(db, "alarm/hour"), parseInt(hour.value));
      set(ref(db, "alarm/minute"), parseInt(min.value));
    };

    window.enableAlarm = () => set(ref(db, "alarm/enable"), true);
    window.disableAlarm = () => set(ref(db, "alarm/enable"), false);
  </script>
</head>

<body style="font-family:sans-serif;text-align:center">
  <h1>â° Smart Alarm</h1>

  <h2 id="time">--:--:--</h2>

  <hr>

  <h3>à¸•à¸±à¹‰à¸‡à¹€à¸§à¸¥à¸² Alarm</h3>
  <select id="hour">
    <script>for(let i=0;i<24;i++)document.write(`<option>${i}</option>`)</script>
  </select> :
  <select id="min">
    <script>for(let i=0;i<60;i++)document.write(`<option>${i}</option>`)</script>
  </select>

  <br><br>
  <button onclick="setAlarm()">à¸šà¸±à¸™à¸—à¸¶à¸à¹€à¸§à¸¥à¸²</button>
  <br><br>
  <button onclick="enableAlarm()">à¹€à¸›à¸´à¸” Alarm</button>
  <button onclick="disableAlarm()">à¸›à¸´à¸” Alarm</button>

  <p>à¸ªà¸–à¸²à¸™à¸° Alarm: <b id="status">---</b></p>

  <hr>

  <h3>Sensor</h3>
  ğŸŒ¡ à¸­à¸¸à¸“à¸«à¸ à¸¹à¸¡à¸´: <span id="temp"></span> Â°C<br>
  ğŸ’§ à¸„à¸§à¸²à¸¡à¸Šà¸·à¹‰à¸™: <span id="hum"></span> %<br>
  ğŸ’¡ à¹à¸ªà¸‡: <span id="light"></span>

</body>
</html>
