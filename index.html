<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Smart Alarm</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body {
  font-family: sans-serif;
  max-width: 420px;
  margin: auto;
  background: #f2f2f2;
}
h1 {
  text-align: center;
}
.card {
  background: white;
  padding: 15px;
  margin: 10px 0;
  border-radius: 10px;
}
.time-picker {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}
select {
  font-size: 20px;
  padding: 8px;
}
.colon {
  font-size: 22px;
  font-weight: bold;
}
button {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  font-size: 16px;
}
</style>
</head>

<body>

<h1>‚è∞ Smart Alarm</h1>

<div class="card">
  <b>‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</b>
  <div id="now">--:--:--</div>
</div>

<div class="card">
  <b>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ Alarm</b>

  <div class="time-picker">
    <select id="hour"></select>
    <div class="colon">:</div>
    <select id="minute"></select>
  </div>

  <button onclick="setAlarm()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</button>
  <button onclick="alarmOn()">‡πÄ‡∏õ‡∏¥‡∏î Alarm</button>
  <button onclick="alarmOff()">‡∏õ‡∏¥‡∏î Alarm</button>
</div>

<div class="card">
  <b>‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö</b>
  <div>üå° ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥: <span id="temp">0</span> ¬∞C</div>
  <div>üíß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô: <span id="hum">0</span> %</div>
  <div>üí° ‡πÅ‡∏™‡∏á: <span id="light">0</span></div>
</div>

<div class="card">
  <b>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Alarm</b>
  <div id="status">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏±‡∏á</div>
</div>

<script>
/* ===== Firebase ===== */
var firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT.firebaseio.com",
  projectId: "YOUR_PROJECT"
};
firebase.initializeApp(firebaseConfig);
var db = firebase.database();

/* ===== time dropdown ===== */
const hourSel = document.getElementById("hour");
const minSel = document.getElementById("minute");

for (let i = 0; i < 24; i++) {
  let v = i.toString().padStart(2, "0");
  hourSel.innerHTML += `<option value="${i}">${v}</option>`;
}

for (let i = 0; i < 60; i++) {
  let v = i.toString().padStart(2, "0");
  minSel.innerHTML += `<option value="${i}">${v}</option>`;
}

/* ===== realtime ===== */
db.ref("time").on("value", s => {
  document.getElementById("now").innerText = s.val() || "--:--:--";
});

db.ref("sensor").on("value", s => {
  const d = s.val();
  if (!d) return;
  document.getElementById("temp").innerText = d.temperature;
  document.getElementById("hum").innerText = d.humidity;
  document.getElementById("light").innerText = d.light;
});

db.ref("status/alarm_triggered").on("value", s => {
  document.getElementById("status").innerText =
    s.val() ? "‚è∞ Alarm ‡∏î‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß" : "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏î‡∏±‡∏á";
});

/* ===== control ===== */
function setAlarm() {
  db.ref("alarm").update({
    hour: Number(hourSel.value),
    minute: Number(minSel.value)
  });
  alert("‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
}

function alarmOn() {
  db.ref("alarm/enable").set(true);
}

function alarmOff() {
  db.ref("alarm/enable").set(false);
}
</script>

</body>
</html>
