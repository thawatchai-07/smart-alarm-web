<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Smart Alarm</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f2f4f8;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.card{
  background:#fff;
  width:320px;
  padding:20px;
  border-radius:16px;
  box-shadow:0 10px 25px rgba(0,0,0,.15);
  text-align:center;
}
.clock{
  font-size:32px;
  color:#1e88e5;
  margin:10px 0;
}
select,button{
  width:100%;
  padding:10px;
  margin:6px 0;
  font-size:16px;
  border-radius:10px;
}
button{
  border:none;
  color:#fff;
  cursor:pointer;
}
.save{background:#3498db}
.on{background:#2ecc71}
.off{background:#e74c3c}
.sensor{
  margin-top:10px;
  text-align:left;
  font-size:14px;
}
</style>
</head>

<body>
<div class="card">
  <h2>‚è∞ Smart Alarm</h2>

  <!-- ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå -->
  <div class="clock" id="time">--:--:--</div>

  <!-- ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤ -->
  <select id="hour"></select>
  <select id="minute"></select>

  <button class="save" onclick="saveTime()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</button>
  <button class="on" onclick="setAlarm(true)">‡πÄ‡∏õ‡∏¥‡∏î ‡∏£‡∏∞‡∏ö‡∏ö Alarm</button>
  <button class="off" onclick="setAlarm(false)">‡∏õ‡∏¥‡∏î ‡∏£‡∏∞‡∏ö‡∏ö Alarm</button>

  <!-- Sensor -->
  <div class="sensor">
    üå° ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥: <span id="temp">--</span> ¬∞C<br>
    üíß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô: <span id="hum">--</span> %<br>
    üí° ‡πÅ‡∏™‡∏á: <span id="light">--</span>
  </div>
</div>

<script>
// ================= Firebase Config =================
const firebaseConfig = {
  apiKey: "AIzaSyBCsuRaK7arhDgqYz4q2B73U0IoAR6yG9I",
  databaseURL: "smart-alarm-9c9ee-default-rtdb.asia-southeast1.firebasedatabase.app"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ================= ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ =================
for(let i=0;i<24;i++){
  hour.innerHTML += `<option value="${i}">${String(i).padStart(2,'0')}</option>`;
}
for(let i=0;i<60;i++){
  minute.innerHTML += `<option value="${i}">${String(i).padStart(2,'0')}</option>`;
}

// ================= ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤ RTC =================
db.ref("time/current").on("value",snap=>{
  if(snap.exists()){
    document.getElementById("time").innerText = snap.val();
  }
});

// ================= ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ =================
function saveTime(){
  db.ref("alarm").update({
    hour: parseInt(hour.value),
    minute: parseInt(minute.value)
  });
}

// ================= ‡πÄ‡∏õ‡∏¥‡∏î / ‡∏õ‡∏¥‡∏î Alarm =================
function setAlarm(state){
  db.ref("alarm/enable").set(state);
}

// ================= ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤ Alarm =================
db.ref("alarm").on("value",snap=>{
  if(!snap.exists()) return;
  hour.value = snap.val().hour;
  minute.value = snap.val().minute;
});

// ================= Sensor =================
db.ref("sensor").on("value",snap=>{
  if(!snap.exists()) return;
  temp.innerText  = snap.val().temperature;
  hum.innerText   = snap.val().humidity;
  light.innerText = snap.val().light;
});
</script>
</body>
</html>
